<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <title>XMLTask - OOPS Consultancy Ltd</title>
    <meta name="description" content="XMLTask by OOPS Consultancy Ltd provides the facility for automatically editing XML files as part of an Ant build."/>
    <meta name="keywords" content="OOPS Consultancy Brian Agnew Java Ant XML build"/>
    <meta name="rating" content="general"/>
    <meta name="copyright" content="Copyright Â© 2007 - OOPS Consultancy Ltd"/>
    <meta name="revisit-after" content="7 Days"/>
    <meta name="expires" content="never"/>
    <meta name="distribution" content="global"/>
    <meta name="robots" content="index,follow"/>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8"/>
    <link href="design.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <div style="position:absolute;right:1rem;top:1rem;">
      <p style="text-align:right;"><span class="quoteText">"...probably the best custom task around..."</span><br/>
        XmlTask mailing list, November 2005</p>

      <p style="text-align:right;"><span class="quoteText">"...too essential to be left out of the Ant distribution..."</span><br/>
        Ant User mailing list, August 2002</p>

      <p style="text-align:right;"><span class="quoteText">"Keep up the good work - xmltask is invaluable to our promotion process"</span><br/>
        User comment, June 2003</p>
    </div>
    <h2 id="contents">Contents</h2>
    <ul style="list-style-type:none;margin:0;padding:0;">
      <li><a href="#intro">Introduction</a></li>
      <li><a href="#changes">Recent Changes</a></li>
      <li><a href="#usage">Usage</a>
        <input type="checkbox" id="submenu-toggle"/>
        <label for="submenu-toggle" style="cursor:pointer;display:inline;">[+]</label>
        <ul style="list-style-type:none;margin:0 0 0 2rem;padding:0;">
          <li><a href="#usage.xmltask">XmlTask</a></li>
          <li><a href="#usage.attr">Attr</a></li>
          <li><a href="#usage.cut">Cut</a></li>
          <li><a href="#usage.copy">Copy</a></li>
          <li><a href="#usage.paste">Paste</a></li>
          <li><a href="#usage.insert">Insert</a></li>
          <li><a href="#usage.replace">Replace</a></li>
          <li><a href="#usage.regexp">Regexp</a></li>
          <li><a href="#usage.remove">Remove</a></li>
          <li><a href="#usage.rename">Rename</a></li>
          <li><a href="#usage.call">Call</a></li>
          <li><a href="#usage.print">Print</a></li>
          <li><a href="#usage.xmlcatalog">XmlCatalog</a></li>
          <li><a href="#usage.uncomment">Uncomment</a></li>
        </ul>
      </li>
      <li><a href="#buffers">Buffers</a></li>
      <li><a href="#formatting">Formatting</a></li>
      <li><a href="#examples">Examples</a></li>
      <li><a href="#issues">Known Issues</a></li>
      <li><a href="#tutorials">XPath Links</a></li>
      <li><a href="#contact">Contact</a></li>
    </ul>
    <h2 id="intro" style="clear:both;">Introduction</h2>
    <p><b>xmltask</b> provides the facility for automatically editing XML files as part of an <a href="https://ant.apache.org">Ant</a> build. Unlike the standard <code>filter</code> task provided with Ant, it is XML-sensitive, but doesn't require you to define XSLTs.</p>
    <p>Uses include:</p>
    <ul>
      <li>modifying configuration files for applications during builds</li>
      <li>inserting/removing information for J2EE deployment descriptors</li>
      <li>dynamically building Ant build.xml files during builds</li>
      <li>building and maintaining websites built with XHTML</li>
      <li>driving Ant via a <i>meta</i> build.xml to abstract out build processes</li>
    </ul>
    <p>Read more about &lt;xmltask&gt; in the <a href="xml-manipulation-using-xmltask.html">tutorial</a>, previously published on java.net website.</p>
    <p><a href="#top">Top</a></p>
    <h2 id="changes">Recent Changes</h2>
    <ul>
      <li><a href="#usage.regexp">Regular expressions</a> for changing text are now available.</li>
      <li>Copying/cutting to properties can now handle multiple values from an XPath expression. String trimming and concatenation (with a specified separator character) is now supported.</li>
      <li>Support for Java versions prior to 1.5 has been removed.</li>
    </ul>
    <p>See the <code>CHANGES</code> file in the download for a comprehensive list of changes for each version</p>
    <p><a href="#top">Top</a></p>
    <h2 id="how-to">How To Use</h2>
    <p>To use this task, make sure:</p>
    <ul>
      <li><p>The xmltask.jar is in your <code>$CLASSPATH</code></p></li>
      <li><p>Reference the <code>xmltask</code> in your <code>build.xml</code> eg.</p>
        <pre class="prettyprint">&lt;taskdef name="xmltask" classname="com.oopsconsultancy.xmltask.ant.XmlTask"/&gt;</pre></li>
        <!--
        <p>Note that if you use the above with an additional <code>classpath</code> attribute then you will have problems with using buffers across multiple <code>xmltask</code> calls. See <a href="#buffers">Buffers</a> for more information.</p>
         -->
      <li><p>Reference the <code>xmltask</code> task as part of your build eg.</p>
        <pre class="prettyprint">&lt;target name="main"&gt;
  &lt;xmltask source="input.xml" dest="output.xml"&gt;
  ...</pre></li>
    </ul>
    <p><a href="#top">Top</a></p>
    <h2 id="usage">Usage</h2>
    <p id="usage.xmltask">xmltask allows you to specify sections of an XML file to append to, replace, remove or modify. The sections of the XML document to be modified are specified by XPath references, and the XML to insert can be specified in-line in the Ant build.xml, or loaded from files.</p>
    <ul>
      <li>
        <p>The main &lt;xmltask&gt; section takes arguments to define an XML source and a destination file or directory. Note that the XML source is optional if you're creating a new document via &lt;xmltask&gt; instructions. <code>dest</code> and <code>todir</code> can be omitted if you're reading a document and storing subsections in buffers for use by another task (see below).</p>
        <p>&lt;fileset&gt;s are used to define sets of files for <code>xmltask</code> to operate on. See the standard Ant documentation for information on using filesets.</p>
        <!-- xmltask attributes -->
        <h3>Parameters</h3>
        <table>
          <tr>
            <th>Attribute</th>
            <th>Description</th>
            <th>Required</th>
          </tr>
          <tr>
            <td>source</td>
            <td>the source XML file to load. Can take the form of a wildcarded pattern eg. **/*.xml. Note that this capability will be deprecated in favour of &lt;fileset&gt; usage.</td>
            <td>no</td>
          </tr>
          <tr>
            <td>sourcebuffer</td>
            <td>the source <a href="#buffers">buffer</a> containing XML from a previous &lt;xmltask&gt; invocation. The buffer must contain a <i>single</i> root node (i.e be <i>well-formed</i>). If the buffer is empty, then this has the effect of starting with a blank document.</td>
            <td>no</td>
          </tr>
          <tr>
            <td>sourceproperty</td>
            <td>the source property containing XML. The property must contain a <i>single</i> root node (i.e be <i>well-formed</i>). If the property is empty, then this has the effect of starting with a blank document.</td>
            <td>no</td>
          </tr>
          <tr>
            <td>dest</td>
            <td>the output XML file to write to</td>
            <td>no</td>
          </tr>
          <tr>
            <td>destbuffer</td>
            <td>the output buffer to write to</td>
            <td>no</td>
          </tr>
          <tr>
            <td>todir</td>
            <td>the output directory to write to</td>
            <td>no</td>
          </tr>
          <tr>
            <td>report</td>
            <td>when set to true, will result in diagnostic output.</td>
            <td>no</td>
          </tr>
          <tr>
            <td>public</td>
            <td>sets the PUBLIC identifier in the output XML DOCTYPE declaration.</td>
            <td>no</td>
          </tr>
          <tr>
            <td>expandEntityReferences</td>
            <td>when set to true, will enable entity reference expansion. Defaults to true. NB! false is ignored due to a <a href="https://bugs.openjdk.java.net/browse/JDK-8206132">longstanding</a> JRE bug.</td>
            <td>no</td>
          </tr>
          <tr>
            <td>system</td>
            <td>sets the SYSTEM identifier in the output XML DOCTYPE declaration.</td>
            <td>no</td>
          </tr>
          <tr>
            <td>preservetype</td>
            <td>when set to true sets the PUBLIC and SYSTEM identifiers to those of the original document.</td>
            <td>no</td>
          </tr>
          <tr>
            <td>failWithoutMatch</td>
            <td>when set to true will stop the <code>xmltask</code> task (and hence the build process) if any subtask fails to match nodes using the given XPath path.</td>
            <td>no</td>
          </tr>
          <tr>
            <td>indent</td>
            <td>when set to true enables indented formatting of the resultant document. This defaults to true.</td>
            <td>no</td>
          </tr>
          <tr>
            <td>encoding</td>
            <td>determines the character encoding value for the output document.</td>
            <td>no</td>
          </tr>
          <tr>
            <td>outputter</td>
            <td>determines the output mechanism to be used. See <a href="#formatting">formatting</a> for more info.</td>
            <td>no</td>
          </tr>
          <tr>
            <td>omitHeader</td>
            <td>when set to true forces omission of the &lt;?xml...?&gt; header. Note that the XML spec specifies the header SHOULD be included, but this is not mandated for XML v1.0</td>
            <td>no</td>
          </tr>
          <tr>
            <td>standalone</td>
            <td>when set to true/false sets the <code>standalone</code> attribute of the header.</td>
            <td>no</td>
          </tr>
          <tr>
            <td>clearBuffers</td>
            <td>Clears buffers after population by previous <code>xmltask</code> invocations. Buffers are cleared after every input file is processed. Buffers are specified in a comma-delimited string.</td>
            <td>no</td>
          </tr>
          <tr>
            <td>defaultXpathFactory</td>
            <td>Sets the <a href="https://docs.oracle.com/javase/7/docs/api/javax/xml/xpath/XPathFactory.html#newInstance(java.lang.String)">XPathFactory implementation for Default Object Model URI</a>.</td>
            <td>no</td>
          </tr>
          <tr>
            <td>xpathFactory</td>
            <td>Sets the XPathFactory implementation for xpathObjectModelUri explicitly. If defaultXpathFactory is set, the latter takes precedence for Default Object Model URI as per specification.</td>
            <td>no</td>
          </tr>
          <tr>
            <td>xpathObjectModelUri</td>
            <td>Sets the Object Model URI for XPathFactory implementation set by xpathFactory. If not set, implies that the latter is used for Default Object Model URI.</td>
            <td>no</td>
          </tr>
        </table>
        <p>e.g.</p>
        <pre class="prettyprint">&lt;xmltask source="input.xml" dest="output.xml"&gt;</pre>
        <p>reads from <code>input.xml</code> and writes to <code>output.xml</code></p>
        <pre class="prettyprint">&lt;xmltask todir="output"&gt;
  &lt;fileset dir="."&gt;
    &lt;includes name="*.xml"/&gt;</pre>
        <p>reads from the XML files in the current dir and writes to the same filenames in the <code>output</code> dir.</p>
        <pre class="prettyprint">&lt;xmltask sourcebuffer="servlet" output="servlet.xml"&gt;</pre>
        <p>reads from the previously populated buffer <code>servlet</code> and writes to <code>output.xml</code></p>
        <pre class="prettyprint">&lt;xmltask source="input.xml" destbuffer="output"&gt;</pre>
        <p>reads from a file <code>input.xml</code> and writes to the buffer called <code>output</code>.</p>
      </li>
      <li>Nested elements allow replacements to take place, and are applied in the order that they're specified in. Each subsection may match zero or more nodes. Standard XPath paths are used here. If you're not familiar with these, the examples below will provide some hints. See <a href="#tutorials">here</a> for more info.
        <ul>
          <li id="usage.cut">The &lt;cut&gt; section allows an XML section to be cut and stored in a <a href="#buffers">buffer</a> or a property. Multiple XML nodes or elements can be cut to a buffer or property by using the <code>append</code> attribute
            <!-- cut attributes -->
            <h3>Parameters</h3>
            <table>
              <tr>
                <th>Attribute</th>
                <th>Description</th>
                <th>Required</th>
              </tr>
              <tr>
                <td>path</td>
                <td>the XPath reference of the element(s) to cut</td>
                <td>yes</td>
              </tr>
              <tr>
                <td>buffer</td>
                <td>the buffer to store the cut XML</td>
                <td>no</td>
              </tr>
              <tr>
                <td>property</td>
                <td>the property to store the cut XML</td>
                <td>no</td>
              </tr>
              <tr>
                <td>append</td>
                <td>when set to <code>true</code>, <i>appends</i> to the given buffer or property. You can only append when creating a new property since Ant properties are immutable (i.e. when an XPath resolves to multiple text nodes)</td>
                <td>no</td>
              </tr>
              <tr>
                <td>attrValue</td>
                <td>Cutting an attribute will result in the <i>whole</i> attribute plus value being cut. When <code>attrValue</code> is set to true then only the attribute's <i>value</i> is cut. This is <i>implicit</i> for cutting to properties</td>
                <td>no</td>
              </tr>
              <tr>
                <td>trim</td>
                <td>trims leading/trailing spaces when writing to properties</td>
                <td>no</td>
              </tr>
              <tr>
                <td>propertySeparator</td>
                <td>defines the separating string when appending properties</td>
                <td>no</td>
              </tr>
              <tr>
                <td>if</td>
                <td>only performed if the given property is set</td>
                <td>no</td>
              </tr>
              <tr>
                <td>unless</td>
                <td>performed <i>unless</i> the given property is set</td>
                <td>no</td>
              </tr>
            </table>
            <p>e.g.</p>
            <pre class="prettyprint">&lt;cut path="web/servlet/context/root[@id='2']/text()" buffer="namedBuffer"/&gt;
&lt;cut path="web/servlet/context/root[@id='2']/text()" property="property1"/&gt;</pre>
          </li>
          <li id="usage.copy">The &lt;copy&gt; section allows an XML section to be copied and stored in a <a href="#buffers">buffer</a> or a property. Multiple XML nodes or elements can be copied to a buffer or property by using the <code>append</code> attribute
            <!-- copy attributes -->
            <h3>Parameters</h3>
            <table>
              <tr>
                <th>Attribute</th>
                <th>Description</th>
                <th>Required</th>
              </tr>
              <tr>
                <td>path</td>
                <td>the XPath reference of the element(s) to copy</td>
                <td>yes</td>
              </tr>
              <tr>
                <td>buffer</td>
                <td>the buffer to store the copied XML</td>
                <td>no</td>
              </tr>
              <tr>
                <td>property</td>
                <td>the property to store the copied XML</td>
                <td>no</td>
              </tr>
              <tr>
                <td>append</td>
                <td>when set to <code>true</code>, <i>appends</i> to the given buffer or property. You can only append when creating a new property since Ant properties are immutable (i.e. when an XPath resolves to multiple text nodes)</td>
                <td>no</td>
              </tr>
              <tr>
                <td>attrValue</td>
                <td>Copying an attribute will result in the <i>whole</i> attribute plus value being cut. When <code>attrValue</code> is set to true then only the attribute's <i>value</i> is copied. This is now <i>implicit</i> for copying to properties</td>
                <td>no</td>
              </tr>
              <tr>
                <td>propertySeparator</td>
                <td>defines the separating string when appending properties</td>
                <td>no</td>
              </tr>
              <tr>
                <td>trim</td>
                <td>trims leading/trailing spaces when writing to properties</td>
                <td>no</td>
              </tr>
              <tr>
                <td>if</td>
                <td>only performed if the given property is set</td>
                <td>no</td>
              </tr>
              <tr>
                <td>unless</td>
                <td>performed <i>unless</i> the given property is set</td>
                <td>no</td>
              </tr>
            </table>
            <p>e.g.</p>
            <pre class="prettyprint">&lt;copy path="web/servlet/context/root[@id='2']/text()" buffer="namedBuffer"/&gt;
&lt;copy path="web/servlet/context/root[@id='2']/text()" property="property1"/&gt;</pre>
          </li>
          <li id="usage.paste">The &lt;paste&gt; section allows the contents of a <a href="#buffers">buffer</a> or a property to be pasted into an XML document. This is a <b>synonym</b> for the insert section (see below)</li>
          <li id="usage.insert">The &lt;insert&gt; section allows you to specify an XML node and the XML to insert below or alongside it
            <!-- paste/insert attributes -->
            <h3>Parameters</h3>
            <table>
              <tr>
                <th>Attribute</th>
                <th>Description</th>
                <th>Required</th>
              </tr>
              <tr>
                <td>path</td>
                <td>the XPath reference of the element(s) to insert into</td>
                <td>yes</td>
              </tr>
              <tr>
                <td>buffer</td>
                <td>the buffer to paste</td>
                <td>no</td>
              </tr>
              <tr>
                <td>file</td>
                <td>the file to paste</td>
                <td>no</td>
              </tr>
              <tr>
                <td>xml</td>
                <td>the literal XML to paste</td>
                <td>no</td>
              </tr>
              <tr>
                <td>expandProperties</td>
                <td>indicates whether properties in body text XML are expanded or not. Defaults to <code>true</code></td>
                <td>no</td>
              </tr>
              <tr>
                <td>position</td>
                <td>where the XML is to be inserted in relation to the XML highlighted by <code>path</code>. The allowed positions are <code>before, after</code>, or <code>under</code>. The default position is <code>under</code>.</td>
                <td>no</td>
              </tr>
              <tr>
                <td>if</td>
                <td>only performed if the given property is set</td>
                <td>no</td>
              </tr>
              <tr>
                <td>unless</td>
                <td>performed <i>unless</i> the given property is set</td>
                <td>no</td>
              </tr>
            </table>
            <p>e.g.</p>
            <pre class="prettyprint">&lt;insert path="/web/servlet/context/root[@attr='val']" xml="&amp;lt;B/&amp;gt;"/&gt;
&lt;insert path="/web/servlet/context/root[@attr='val']" file="insert.xml"/&gt;
&lt;insert path="/web/servlet/context/root[@attr='val']" buffer="namedBuffer" position="before"/&gt;
&lt;insert path="/web/servlet/context/root[@attr='val']" xml="${property1}" position="before"/&gt;</pre>
            <p>The XML to insert can be a <i>document fragment</i> - that is to say it doesn't require a root node. Examples of insertable XML include:</p>
            <pre class="prettyprint">&lt;welcome-file-list/&gt;</pre>
            <p>(a well formed document)</p>
            <pre class="prettyprint">&lt;servlet-mapping id="1"/&gt;&lt;servlet-mapping id="2"/&gt;</pre>
            <p>(a well-formed document without a root node)</p>
            <p>The XML to insert can be specified as <i>body text</i> within the &lt;insert&gt; task eg.</p>
            <pre class="prettyprint">&lt;insert path="web/servlet/context/root[@id='2']/text()"&gt;
  &lt;![CDATA[
    &lt;node/&gt;
  ]]&gt;
&lt;/insert&gt;</pre>
            <p>Note that the XML has to be specified within a <code>CDATA</code> section. Ant properties are expanded within these sections, unless <code>expandProperties</code> is set to <code>false</code></p>
            <p>You can create a new document by not specifying a source file, and making the first instruction for &lt;xmltask&gt; an &lt;insert&gt; or &lt;paste&gt; with the appropriate root node (and any subnodes).</p>
          </li>
          <li id="usage.replace">The &lt;replace&gt; section allows you to specify an XML node and what to replace it with
            <!-- replace attributes -->
            <h3>Parameters</h3>
            <table>
              <tr>
                <th>Attribute</th>
                <th>Description</th>
                <th>Required</th>
              </tr>
              <tr>
                <td>path</td>
                <td>the XPath reference of the element(s) to replace. If this represents an attribute, then the value of the attribute will be changed. In this scenario you can only specify text as replacement</td>
                <td>yes</td>
              </tr>
              <tr>
                <td>withText</td>
                <td>the text to insert in place of the nominated nodes</td>
                <td>no</td>
              </tr>
              <tr>
                <td>withXml</td>
                <td>the literal XML to insert in place of the nominated nodes</td>
                <td>no</td>
              </tr>
              <tr>
                <td>withFile</td>
                <td>the file containing XML to insert in place of the nominated nodes</td>
                <td>no</td>
              </tr>
              <tr>
                <td>withBuffer</td>
                <td>the buffer containing XML to insert in place of the nominated nodes</td>
                <td>no</td>
              </tr>
              <tr>
                <td>expandProperties</td>
                <td>indicates whether properties in body text XML are expanded or not. Defaults to <code>true</code></td>
                <td>no</td>
              </tr>
              <tr>
                <td>if</td>
                <td>only performed if the given property is set</td>
                <td>no</td>
              </tr>
              <tr>
                <td>unless</td>
                <td>performed <i>unless</i> the given property is set</td>
                <td>no</td>
              </tr>
            </table>
            <p>e.g.</p>
            <pre class="prettyprint">&lt;replace path="web/servlet/context/root[@id='2']/text()" withText="2"/&gt;

&lt;replace path="web/servlet/context/root[@id='2']/@id" withText="3"/&gt;
&lt;replace path="web/servlet/context/root[@id='2']/text()" withXml="&amp;lt;id&amp;gt;"/&gt;
&lt;replace path="web/servlet/context/root[@id='2']/" withFile="substitution.xml"/&gt;
&lt;replace path="web/servlet/context/root[@id='2']/" withBuffer="namedBuffer"/&gt;</pre>
            <p>(note that to include literal XML using <code>withXml</code>, angle brackets have to be replaced with entities). The XML can be a well-formed document <i>without</i> any root node. The XML to insert can be specified as <i>body text</i> within the &lt;replace&gt; task eg.</p>
            <pre class="prettyprint">&lt;replace path="web/servlet/context/root[@id='2']/text()"&gt;
  &lt;![CDATA[
    &lt;node/&gt;
  ]]&gt;
&lt;/replace&gt;</pre>
            <p>Note that the XML has to be specified within a <code>CDATA</code> section. Ant properties are expanded within these sections, unless <code>expandProperties</code> is set to <code>false</code></p>
          </li>
          <li id="usage.attr">The &lt;attr&gt; section allows you to specify an XML node and how to add, change or remove its attributes
            <!-- attr attributes -->
            <h3>Parameters</h3>
            <table>
              <tr>
                <th>Attribute</th>
                <th>Description</th>
                <th>Required</th>
              </tr>
              <tr>
                <td>path</td>
                <td>the XPath reference of the element(s) to be changed</td>
                <td>yes</td>
              </tr>
              <tr>
                <td>attr</td>
                <td>the name of the attribute to be added/changed or removed</td>
                <td>yes</td>
              </tr>
              <tr>
                <td>value</td>
                <td>the value to set the attribute to</td>
                <td>no</td>
              </tr>
              <tr>
                <td>remove</td>
                <td>if set to <code>true</code>, indicates that the nominated attribute should be removed</td>
                <td>no</td>
              </tr>
              <tr>
                <td>if</td>
                <td>only performed if the given property is set</td>
                <td>no</td>
              </tr>
              <tr>
                <td>unless</td>
                <td>performed <i>unless</i> the given property is set</td>
                <td>no</td>
              </tr>
            </table>
            <p>e.g.</p>
            <pre class="prettyprint">&lt;attr path="web/servlet/context[@id='4']/" attr="id" value="test"/&gt;
&lt;attr path="web/servlet/context[@id='4']/" attr="id" remove="true"/&gt;</pre>
            <p>Note that in the first example, if the attribute <code>id</code> doesn't exist, it will be added.</p>
          </li>
          <li id="usage.remove">The &lt;remove&gt; section allows you to specify an XML section to remove
            <!-- remove attributes -->
            <h3>Parameters</h3>
            <table>
              <tr>
                <th>Attribute</th>
                <th>Description</th>
                <th>Required</th>
              </tr>
              <tr>
                <td>path</td>
                <td>the XPath reference of the element(s) to be removed</td>
                <td>yes</td>
              </tr>
              <tr>
                <td>if</td>
                <td>only performed if the given property is set</td>
                <td>no</td>
              </tr>
              <tr>
                <td>unless</td>
                <td>performed <i>unless</i> the given property is set</td>
                <td>no</td>
              </tr>
            </table>
            <p>e.g.</p>
            <pre class="prettyprint">&lt;remove path="web/servlet/context[@id='redundant']"/&gt;</pre>
          </li>
          <li id="usage.regexp">The &lt;regexp&gt; section allows you to specify XML text to change via regular expressions.
            <!-- regexp attributes -->
            <h3>Parameters</h3>
            <table>
              <tr>
                <th>Attribute</th>
                <th>Description</th>
                <th>Required</th>
              </tr>
              <tr>
                <td>path</td>
                <td>the XPath reference of the element(s) to be changed or copied</td>
                <td>yes</td>
              </tr>
              <tr>
                <td>pattern</td>
                <td>The regular expression to apply to the text node or attribute value</td>
                <td>yes</td>
              </tr>
              <tr>
                <td>replace</td>
                <td>The text to replace the matched expression with</td>
                <td>no</td>
              </tr>
              <tr>
                <td>property</td>
                <td>The property to copy the matched expression into. A <a href="https://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html#cg">capturing group</a> must be used to specify the text to capture</td>
                <td>no</td>
              </tr>
              <tr>
                <td>buffer</td>
                <td>The buffer to copy the matched expression into. A <a href="https://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html#cg">capturing group</a> must be used to specify the text to capture</td>
                <td>no</td>
              </tr>
              <tr>
                <td>casesensitive</td>
                <td>Sets case sensitivity of the regular expression. Defaults to <i>true</i></td>
                <td>no</td>
              </tr>
              <tr>
                <td>if</td>
                <td>only performed if the given property is set</td>
                <td>no</td>
              </tr>
              <tr>
                <td>unless</td>
                <td>performed <i>unless</i> the given property is set</td>
                <td>no</td>
              </tr>
            </table>
            <p>The <code>&lt;regexp&gt;</code> task uses the standard <a href="https://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html">Java regular expression mechanism</a>. Replacements can make use of <a href="https://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html#cg">capturing groups</a>. When copying to a buffer or a property, a capturing group <i>must</i> be specified to determine the text to be copied.</p>
            <p>e.g.</p>
            <pre class="prettyprint">&lt;regexp path="/web-app/servlet/servlet-name/text()" pattern="Test" replace="Prod"/&gt;
&lt;regexp path="/web-app/servlet/servlet-name/text()" pattern="Servlet-([a-z])-([0-9]*)" replace="Servlet-$2-$1"/&gt;
&lt;regexp path="/web-app/servlet/servlet-name/text()" pattern="(.*)Test" property="servlet.name"/&gt;
&lt;regexp path="/web-app/servlet/servlet-name/text()" pattern="(.*)Test" buffer="servlet.name"/&gt;</pre>
            <p>Note the use of the capturing groups to reverse components of the servlet's name, or to determine the servlet name substring to copy to a buffer or property.</p>
          </li>
          <li id="usage.rename">The &lt;rename&gt; section allows you to specify an XML element or attribute to rename
            <!-- rename attributes -->
            <h3>Parameters</h3>
            <table>
              <tr>
                <th>Attribute</th>
                <th>Description</th>
                <th>Required</th>
              </tr>
              <tr>
                <td>path</td>
                <td>the XPath reference of the element(s) to be renamed</td>
                <td>yes</td>
              </tr>
              <tr>
                <td>to</td>
                <td>the new node name</td>
                <td>yes</td>
              </tr>
              <tr>
                <td>if</td>
                <td>only performed if the given property is set</td>
                <td>no</td>
              </tr>
              <tr>
                <td>unless</td>
                <td>performed <i>unless</i> the given property is set</td>
                <td>no</td>
              </tr>
            </table>
            <p>e.g.</p>
            <pre class="prettyprint">&lt;rename path="a/b/c[@id='1']" to="d"/&gt;
&lt;rename path="a/b/@c" to="d"/&gt;</pre>
          </li>
          <!-- call documentation -->
          <li id="usage.call">The &lt;call&gt; section allows you to perform actions or call Ant targets in the same <code>build.xml</code> file for nodes identified by an XPath.
            <h3>Parameters</h3>
            <table>
              <tr>
                <th>Attribute</th>
                <th>Description</th>
                <th>Required</th>
              </tr>
              <tr>
                <td>path</td>
                <td>the XPath reference of the element(s) to be identified</td>
                <td>yes</td>
              </tr>
              <tr>
                <td>target</td>
                <td>the Ant target to call for each identified node</td>
                <td>no</td>
              </tr>
              <tr>
                <td>buffer</td>
                <td>the buffer to use to store each identified node (for the duration of the target call)</td>
                <td>no</td>
              </tr>
              <tr>
                <td>inheritAll</td>
                <td>boolean indicating if the target being called inherits all properties. Defaults to <i>true</i></td>
                <td>no</td>
              </tr>
              <tr>
                <td>inheritRefs</td>
                <td>boolean indicating if the target being called inherits all references. Defaults to <i>false</i></td>
                <td>no</td>
              </tr>
              <tr>
                <td>if</td>
                <td>only performed if the given property is set</td>
                <td>no</td>
              </tr>
              <tr>
                <td>unless</td>
                <td>performed <i>unless</i> the given property is set</td>
                <td>no</td>
              </tr>
            </table>
            <p>e.g. in the below example, the Ant target <code>CNode</code> is called for <i>each</i> occurrence of the <code>C</code> node in the given XPath expression. For each call to <code>CNode</code> the buffer <code>abc</code> is populated with the node identified (plus any subnodes).</p>
            <pre class="prettyprint">&lt;call path="a/b/c" target="CNode" buffer="abc"/&gt;</pre>
            <p>In the below example, Ant actions are <i>embedded</i> within the <code>&lt;call&gt;</code> action (Ant 1.6 and above only):</p>
            <pre class="prettyprint">&lt;call path="a/b/c"&gt;
  &lt;actions&gt;
    &lt;echo&gt;Found a node under a/b/c&lt;/echo&gt;
  &lt;/actions&gt;
&lt;/call&gt;</pre>
            <p>This mechanism can be used to drive Ant builds from existing XML resources such as <code>web.xml</code> or <code>struts.xml</code>, or to provide a <code>meta-build</code> facility for Ant, by driving the <code>build.xml</code> from a higher level proprietary XML config.</p>
            <p>Properties can be set for the target being called using XPath syntax or simply as existing properties or static strings. eg.</p>
            <pre class="prettyprint">&lt;call path="a/b/c" target="CNode" buffer="abc"&gt;
  &lt;param name="val" path="text()"/&gt;
  &lt;param name="id" path="@id" default="n/a"/&gt;
  &lt;param name="os" value="${os.name}"/&gt;
&lt;/call&gt;</pre>
            <p>will call the Ant target <code>CNode</code> as above, but for each invocation, the property <i>val</i> is set to the value of the text node under <code>C</code>, and the property id is set to the corresponding id attribute. If the id attribute is missing then "n/a" will be substituted. <i>os</i> is set to the OS.</p>
            <p>The same can be done for <i>embedded</i> actions:</p>
            <pre class="prettyprint">&lt;call path="a/b/c"&gt;
  &lt;param name="val" path="text()"/&gt;
  &lt;param name="id" path="@id" default="n/a"/&gt;
  &lt;param name="os" value="${os.name}"/&gt;
  &lt;actions&gt;
    &lt;echo&gt;val = @{val}&lt;/echo&gt;
    &lt;echo&gt;id = @{id}&lt;/echo&gt;
  &lt;/actions&gt;
&lt;/call&gt;</pre>
            <p>Note how the parameters are dereferenced in this example (using <b>@{...}</b>). Note also that for embedded actions each property <i>must</i> have a value assigned to it. If in doubt use the <code>default</code> attribute in the <code>&lt;param&gt;</code> instruction.</p>
          </li>
          <!-- print documentation -->
          <li id="usage.print">The &lt;print&gt; section allows you to dump out to standard output the XML matching a given XPath expression, or the contents of a buffer. This is a considerable help in performing debugging of scripts
            <h3>Parameters</h3>
            <table>
              <tr>
                <th>Attribute</th>
                <th>Description</th>
                <th>Required</th>
              </tr>
              <tr>
                <td>path</td>
                <td>the XPath reference of the element(s) to be identified</td>
                <td>no</td>
              </tr>
              <tr>
                <td>buffer</td>
                <td>the buffer to print out</td>
                <td>no</td>
              </tr>
              <tr>
                <td>comment</td>
                <td>a corresponding comment to print out</td>
                <td>no</td>
              </tr>
            </table>
            <p>e.g..</p>
            <pre class="prettyprint">&lt;print path="a/b/c" comment="Nodes matching a/b/c"/&gt;
&lt;print buffer="buffer1" comment="Contents of buffer 1"/&gt;</pre>
            <p>This instruction has no effect on the documents being scanned or generated.</p>
          </li>
          <!-- xmltask xmlcatalog settings -->
          <li id="usage.xmlcatalog"><code>xmltask</code> now supports the Ant 1.5 <a href="https://ant.apache.org/manual/Types/xmlcatalog.html">&lt;xmlcatalog&gt;</a> element, which allows you to specify local copies of DTDs. This allows you to specify a DOCTYPE referred to in the original document, and the local DTD to use instead (useful if you're behind firewalls and the like).
            <p>e.g.</p>
            <pre class="prettyprint">&lt;xmlcatalog id="<b>dtds</b>"&gt;
  &lt;dtd publicId="-//OOPS Consultancy//DTD Test 1.0//EN" location="./local.dtd"/&gt;
&lt;/xmlcatalog&gt;

&lt;xmltask source="18.xml" dest="18-out.xml" report="true"&gt;
  &lt;xmlcatalog refid="<b>dtds</b>"/&gt;
  &lt;!-- set a text element to a value --&gt;
  ...
&lt;/xmltask&gt;</pre>
            <p>references a local copy of a DTD.</p>
            <p>Alternatively, you can use the legacy &lt;entity&gt; element within &lt;xmltask&gt;, as below:</p>
            <pre class="prettyprint">&lt;entity remote="-//Sun Microsystems, Inc.//DTD Web Application 2.2//EN" local="web.dtd"/&gt;
&lt;entity remote="-//Sun Microsystems, Inc.//DTD Web Application 2.2//EN" local=""/&gt;</pre>
            <p>The first version above specifies a local version of the DTD. The second indicates that the remote entity will be ignored completely. Note that the <code>remote</code> attribute can take either the PUBLIC specification or the SYSTEM specification.</p>
          </li>
          <!-- xmltask uncomment settings -->
          <li id="usage.uncomment">The <code>uncomment</code> instruction allows you to uncomment sections of XML. This means you can maintain different XML fragments within one document and enable a subset. For instance you can maintain different configs and only enable one at deployment
            <h3>Parameters</h3>
            <table>
              <tr>
                <th>Attribute</th>
                <th>Description</th>
                <th>Required</th>
              </tr>
              <tr>
                <td>path</td>
                <td>the path of the comment to uncomment. This must resolve to a comment within the input document</td>
                <td>yes</td>
              </tr>
              <tr>
                <td>if</td>
                <td>only performed if the given property is set</td>
                <td>no</td>
              </tr>
              <tr>
                <td>unless</td>
                <td>performed <i>unless</i> the given property is set</td>
                <td>no</td>
              </tr>
            </table>
            <p>e.g.</p>
            <pre class="prettyprint">&lt;xmltask source="server.xml" dest="server.xml" report="true"&gt;
  &lt;!-- enables a servlet configuration --&gt;
  &lt;uncomment path="/server/service[@name='Tomcat-Standalone']/comment()"/&gt;
  ...
&lt;/xmltask&gt;</pre>
          </li>
        </ul>
      </li>
      <!-- stringing together bits -->
      <li>The sections above can be chained together to provide successive modifications to an XML file eg.
        <pre class="prettyprint">&lt;target name="main"&gt;
  &lt;xmltask source="input.xml"
           dest="output.xml
           public="//Sun Microsystems, Inc.//DTD Web Application 2.2//EN"
           system="http://java.sun.com/j2ee/dtds/web-app_2_2.dtd"
           report="true"&gt;
    &lt;replace path="web/servlet/context/config[@id='1']/text()" withFile="config1.xml"/&gt;
    &lt;replace path="web/servlet/context/config[@id='2']/text()" withFile="config2.xml"/&gt;
    &lt;insert path="/web/security/" file="uat.security.xml"/&gt;
    &lt;remove path="web/servlet/context/config[@id='4']"/&gt;
  &lt;/xmltask&gt;
&lt;/target&gt;</pre>
        <p>Here the <code>report</code> attribute is enabled to view the XML transformations as they occur. The input is loaded from <code>input.xml</code> and the output will go to <code>output.xml</code>. The files <code>config1/2.xml</code> replace the text below the appropriate &lt;config&gt; nodes, the file <code>security.xml</code> is inserted and then the config id #4 is removed. <code>output.xml</code> will be output with the appropriate <code>DOCTYPE</code> setting for a Servlet 2.2 <code>web.xml</code> (using the <code>public</code>/<code>system</code> settings - note that if <code>input.xml</code> has the <code>public</code> and <code>system</code> ids set already, <code>preserveType="true"</code> could be used here).</p>
      </li>
    </ul>
    <p><a href="#top">Top</a></p>
    <h2 id="buffers">Buffers</h2>
    <p>Buffers are used to store nodes found by <a href="#usage.cut">&lt;cut&gt;</a> and <a href="#usage.copy">&lt;copy&gt;</a> operations, and those nodes can be inserted into a document using <a href="#usage.insert">&lt;insert&gt; / &lt;paste&gt;</a>.</p>
    <p>Buffers exist for the duration of the Ant process and consequently can be used across multiple invocations of &lt;xmltask&gt;. eg. the following is possible:</p>
    <pre class="prettyprint">&lt;target name="cut"&gt;
  &lt;xmltask source="input.xml" dest="1.xml"&gt;
    &lt;cut path="web/servlet/context/config[@id='4']" buffer="storedXml"/&gt;
  &lt;/xmltask&gt;
&lt;/target&gt;

&lt;target name="paste" depends="cut"&gt;
  &lt;xmltask source="input.xml" dest="output.xml"&gt;
    &lt;paste path="web/servlet/context/config[@id='5'] buffer="storedXml"/&gt;
  &lt;/xmltask&gt;
&lt;/target&gt;</pre>
    <p>so the buffer <i>storedXml</i> is maintained across multiple targets.</p>
    <p>Buffers are simply defined by names. eg. valid buffers would be <i>servlet</i>, <i>buffer100</i> etc.</p>
    <p>A buffer can record <i>multiple</i> nodes (either resulting from multiple matches or multiple &lt;cut&gt; / &lt;copy&gt; operations). This operation is enabled through use of the <code>append</code> attribute. e.g.</p>
    <pre class="prettyprint">&lt;cut path="web/servlet/context/config" buffer="storedXml" append="true"/&gt;</pre>
    <p>A buffer can store all types of XML nodes e.g. text / elements / attributes. Note that when recording an attribute node, both the name of the attribute and the value will be recorded. To store the value alone of an attribute, the <code>attrValue</code> attribute can be used e.g.</p>
    <pre class="prettyprint">&lt;copy path="web/servlet/@id" buffer="id" attrValue="true"/&gt;</pre>
    <p>This will store the value of the <code>id</code> attribute. The value can be used as a text node in a subsequent <a href="#usage.insert">&lt;insert&gt;</a> / <a href="#usage.paste">&lt;paste&gt;</a>.</p>
    <p>Buffers can be persisted to files. This permits buffers to be used across Ant invocations, and uses of <code><a href="https://ant.apache.org/manual/Tasks/antcall.html">&lt;antcall&gt;</a></code>. To persist a buffer to a file, simply name it using a file URL. e.g.</p>
    <pre class="prettyprint">&lt;cut path="/a/b" buffer="file://build/buffers/1"/&gt;</pre>
    <p>and the operation will write the cut XML to a file <code>build/buffers/1</code>. This file will persist after Ant exits, so care should be taken to remove this if required. The file will be created automatically, but any directories required must exist prior to the buffer being used.</p>
    <p><a href="#top">Top</a></p>
    <h2 id="formatting">Formatting</h2>
    <p>The formatting of the output document is controlled by the attribute 'outputter'. There are three options:</p>
    <pre class="prettyprint">&lt;xmltask outputter="default"...&gt;</pre>
    <p>outputs the document <i>as is</i>. That is to say, all whitespace etc. is preserved. This is the default option. Note that attribute ordering <i>may</i> change and elements containing attributes may be split over several lines etc. ie. the document remains the same <i>semantically</i>.</p>
    <pre class="prettyprint">&lt;xmltask outputter="simple"...&gt;</pre>
    <p>outputs the document with a degree of formatting. Elements are indented and given new lines wherever possible to make a more readable document. This is not suitable for all applications since some XML consumers will be whitespace sensitive.</p>
    <p>Spacing can be adjusted by using <code class="prettyprint">&lt;xmltask outputter="simple:{indent}..."&gt;</code>. e.g. <code class="prettyprint">&lt;xmltask outputter="simple:1"...&gt;</code> results in:</p>
    <pre class="prettyprint">&lt;root&gt;
 &lt;branch/&gt;
&lt;/root&gt;</pre>
    <p>The indent level can be increased: <code class="prettyprint">&lt;xmltask outputter="simple:4"...&gt;</code> results in:</p>
    <pre class="prettyprint">&lt;root&gt;
    &lt;branch/&gt;
&lt;/root&gt;</pre>
    <pre class="prettyprint">&lt;xmltask outputter="{classname}"...&gt;</pre>
    <p>outputs the document using the nominated class as the outputting mechanism. This allows you to control the output of the document to your own tastes. The specified class must:</p>
    <ol>
      <li>have a default constructor (i.e. no arguments)</li>
      <li>implement the <code>com.oopsconsultancy.xmltask.output.Outputter</code> interface.</li>
    </ol>
    <p>The custom class will be loaded and instantiated, then passed to a javax.xml.transform.sax.SAXResult object. Hence the outputter object will receive SAX events for each node in the resultant XML document. Note:</p>
    <ol>
      <li><code>com.oopsconsultancy.xmltask.output.Outputter</code> extends <code>org.xml.sax.ContentHandler</code>, so the appropriate SAX methods need to be implemented.</li>
      <li>The standard SAX callbacks will not include callbacks for comments, <code>CDATA</code> sections etc. If you want to receive these events, then you also need to implement the <code>org.xml.sax.ext.LexicalHandler</code> interface as well.</li>
      <li>For each callback, you should generate your results and write them to the writer object passed in via <code>setWriter()</code></li>
    </ol>
    <p>A simple introduction is to look at the <code>com.oopsconsultancy.xmltask.output.FormattedDataWriter</code> source code (in the source tarball).</p>
    <p><a href="#top">Top</a></p>
    <h2 id="examples">Examples</h2>
    <p>Some examples of common usage:</p>
    <ul>
      <li>Extracting the title from an XHTML file and storing it in a buffer:
        <pre class="prettyprint">&lt;copy path="/xhtml/head/title/text()" buffer="title"/&gt;</pre>
      </li>
      <li>Extracting the title from an XHTML file and storing it in a property:
        <pre class="prettyprint">&lt;copy path="/xhtml/head/title/text()" property="title"/&gt;</pre>
      </li>
      <li>Inserting a servlet definition into a <code>web.xml</code>. Note how this occurs <i>only</i> if the property <code>insert.reqd</code> is set:
        <pre class="prettyprint">&lt;insert if="insert.reqd" path="/web-xml/servlet[last()]" position="after" file="newservlet.xml"/&gt;</pre>
      </li>
      <li>Inserting a servlet definition into a <code>web.xml</code> (another way - note properties usage):
        <pre class="prettyprint">&lt;insert path="/web-xml/servlet[last()]" position="after"&gt;
  &lt;![CDATA[
    &lt;servlet&gt;`
      &lt;servlet-name&gt;
        ${project.name}
      &lt;/servlet-name&gt;
    &lt;/servlet&gt;
  ]]&gt;
&lt;/insert&gt;</pre>
      </li>
      <li>Replacing text occurrences within particular div tags:
        <pre class="prettyprint">&lt;replace path="//div[@id='changeMe']/text()" withText="new text"/&gt;</pre>
      </li>
      <li>Changing an attribute (method number 1):
        <pre class="prettyprint">&lt;attr path="//div[@id='1']" attr="id" value="2"/&gt;</pre>
      </li>
      <li>Changing an attribute (method number 2):
        <pre class="prettyprint">&lt;replace path="//div[@id='1']/@id" withText="2"/&gt;</pre>
      </li>
      <li>Removing an attribute:
        <pre class="prettyprint">&lt;remove path="//div[@id='1']/@id"/&gt;</pre>
      </li>
      <li>Removing an attribute (another way):
        <pre class="prettyprint">&lt;attr path="//div[@id='1']" attr="id" remove="true"/&gt;</pre>
      </li>
      <li>Copying an attribute's value into a buffer:
        <pre class="prettyprint">&lt;copy path="//div[@id='1']/@id" attrValue="true" buffer="bufferName"/&gt;</pre>
      </li>
      <li>Copying an attribute's value into a property:
        <pre class="prettyprint">&lt;copy path="//div[@id='1']/@id" property="propertyName"/&gt;</pre>
      </li>
      <li>Copying multiple values into one buffer. Note the clearing of buffers <code>a, b</code> and <code>c</code> prior to appending. Buffer <code>b</code> contains all the <code>div</code> elements for each input file:
        <pre class="prettyprint">&lt;xmltask clearBuffers="a,b,c"&gt;
  &lt;fileset dir="."&gt;
    &lt;includes name="*.xml"/&gt;
  &lt;/fileset&gt;
  &lt;copy path="//div" buffer="b" append="true"/&gt;
  ...</pre>
      </li>
      <li>Removing all comments:
        <pre class="prettyprint">&lt;remove path="//child::comment()"/&gt;</pre>
      </li>
      <li>Inserting the appropriate system identifiers in a transformed <code>web.xml</code>:
        <pre class="prettyprint">&lt;xmltask source="web.xml" dest="release/web.xml"
         public="-//Sun Microsystems, Inc.//DTD Web Application 2.2//EN"
         system="http://java.sun.com/j2ee/dtds/web-app_2_2.dtd"&gt;
  ...</pre>
        <p><i>OR</i></p>
        <pre class="prettyprint">&lt;xmltask source="web.xml" dest="release/web.xml"
         preserveType="true"&gt;
  ...</pre>
        <p>if you're transforming an existing <code>web.xml</code>.</p>
      </li>
      <li>Setting the output character set to Japanese encoding:
        <pre class="prettyprint">&lt;xmltask source="web.xml" dest="release/web.xml"
         encoding="Shift-JIS"&gt;
  ...</pre>
      </li>
      <li>Converting all unordered lists in an XHTML document to ordered lists
        <pre class="prettyprint">&lt;rename path="//ul" to="ol"/&gt;</pre>
      </li>
      <li>Creating a new document with a root node &lt;root&gt;
        <pre class="prettyprint">&lt;xmltask dest="release/web.xml"&gt;
  &lt;insert path="/"&gt;
    &lt;![CDATA[
      &lt;root/&gt;
    ]]&gt;
  &lt;/insert&gt;
  ...</pre>
      </li>
      <li>Counting nodes and recording the result in a property
        <pre class="prettyprint">&lt;xmltask source="multiple.xml"&gt;
  &lt;copy path="count(/servlet)" property="count"/&gt;
  ...</pre>
      </li>
      <li>Identifying elements with namespaces. This example copies the <code>node</code> element which is tied to a namespace via an <code>xmlns</code> directive. See <a href="https://www.xml.com/pub/a/2004/02/25/qanda.html">this XML.com article</a> for namespace-related issues.
        <pre class="prettyprint">&lt;xmltask source="input.xml"&gt;
  &lt;copy path="//*[local-name()='node']" property="count"/&gt;
  ...</pre>
      </li>
      <li>Call the <i>deploy</i> task for each servlet entry in a <code>web.xml</code>. For each invocation the <code>servletDef</code> buffer contains the complete servlet specification from the deployment file, and the property <i>id</i> contains the servlet id (if there is no id attribute then <i>NO ID</i> will be substituted). The <code>servletDef</code> buffer can be used in succeeding <code>xmltask</code> invocations.
        <pre class="prettyprint">&lt;xmltask source="web.xml"&gt;
  &lt;call path="web/servlet" target="deploy" buffer="servletDef"&gt;
    &lt;param name="id" path="@id" default="NO ID"/&gt;
  &lt;/call&gt;
&lt;/xmltask&gt;</pre>
      </li>
      <li>Performs actions for each servlet entry in a <code>web.xml</code>. For each invocation the embedded actions are performed (Ant 1.6 and above only).
        <pre class="prettyprint">&lt;xmltask source="web.xml"&gt;
  &lt;call path="web/servlet"&gt;
    &lt;param name="id" path="@id" default="NO ID"/&gt;
    &lt;actions&gt;
      &lt;echo&gt;Found a servlet @{id}&lt;/echo&gt;
      &lt;!-- perform deployment actions --&gt;
      ....
    &lt;/actions&gt;
  &lt;/call&gt;
&lt;/xmltask&gt;</pre>
      </li>
      <li>Uncomment and thus enable a set of users in a <code>tomcat-users.xml</code> file. The users are set up in the first 2 comments
        <pre class="prettyprint">&lt;xmltask source="tomcat-users.xml"&gt;
  &lt;uncomment path="tomcat-users/comment()[1]"/&gt;
  &lt;uncomment path="tomcat-users/comment()[2]"/&gt;
&lt;/xmltask&gt;</pre>
      </li>
      <li>Cutting a section of XML to a buffer, and displaying the buffer to confirm to the developer that a suitable XML fragment has been identified/stored
        <pre class="prettyprint">&lt;xmltask source="input.xml"&gt;
  &lt;cut path="web/servlet[@id='1']" buffer="servlet"/&gt;
  &lt;print buffer="servlet" comment="Copied to 'servlet' buffer"/&gt;
  ...</pre>
      </li>
      <li>Cutting a section of XML to a persisted buffer (the file <code>buffers/servlet</code>) for later use
        <pre class="prettyprint">&lt;xmltask source="input.xml"&gt;
  &lt;cut path="web/servlet[@id='1']" buffer="file://build/buffers/servlet"/&gt;
  ...</pre>
      </li>
    </ul>
    <p><a href="#top">Top</a></p>
    <h2 id="issues">Known Issues</h2>
    <!--
    <p>Importing &lt;xmltask&gt; into an Ant script using the optional <code>classpath</code> attribute of &lt;taskdef&gt; will result in problems using buffers between individual invocations of &lt;xmltask&gt;. In particular buffer contents will not be preserved. Import as per the <a href="#usage">usage instructions</a> will work fine.</p>
    -->
    <p>The Java 1.4.2 release as of June 2003 has tightened up XPath parsing and what is regarded as acceptable XPath syntax. In particular, the following usage of trailing path separators is now regarded as incorrect:</p>
    <pre>/root/branch/</pre>
    <p>and should be replaced with</p>
    <pre>/root/branch</pre>
    <p>Some of the <code>xmltask</code> examples and documentation have used the incorrect syntax. This is now rectified.</p>
    <p><a href="#top">Top</a></p>
    <h2 id="tutorials">XPath Links</h2>
    <p>The XPath spec can be found <a href="https://www.w3.org/TR/xpath/all">here</a></p>
    <p>An excellent XPath tutorial can be found <a href="http://www.zvon.org/xxl/XPathTutorial/General/examples.html">here</a></p>
    <p>Hints and tips on XPath can be found at <a href="https://www.xml.com/pub/a/2002/08/14/xpath_tips.html">O'Reilly's XML web site</a></p>
    <p>Many Xpath issues relate to namespace matching. <a href="https://www.xml.com/pub/a/2004/02/25/qanda.html">This XML.com article</a> offers an excellent discussion of the issues.</p>
    <p>The following books are invaluable for XPath issues:</p>
    <table style="border:0;">
      <tr>
        <td style="border:0;text-align:center;"><a href="http://www.amazon.co.uk/exec/obidos/ASIN/0596002912/oopsconsultanclt"><img style="border:0;height:140px;width:93px;" alt="XPath and XPointer" src="xpathandxpointer.jpg"/></a></td>
        <td style="border:0;text-align:center;"><a href="http://www.amazon.co.uk/exec/obidos/ASIN/0596000537/oopsconsultanclt"><img style="border:0;height:140px;width:93px;" alt="XSLT" src="xslt.jpg"/></a></td>
      </tr>
      <tr>
        <td style="border:0;text-align:center;"><i>XPath and XPointer</i>&nbsp;by John E. Simpson</td>
        <td style="border:0;text-align:center;"><i>XSLT</i>&nbsp;by Doug Tidwell. Contains<br/>
          useful XPath information</td>
      </tr>
    </table>
    <p style="clear:both;"><a href="#top">Top</a></p>
    <h2 id="contact">Contact</h2>
    <p>xmltask is written by <a href="http://www.oopsconsultancy.com/">OOPS Consultancy Ltd.</a>.</p>
    <p><small>Copyright &copy; 1997-2006 OOPS Consultancy Ltd</small></p>
  </body>
</html>
